<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ask Sivan</title>
  <style>
    :root{
      --ink:#0b1020;
      --muted:#334155;
      --ball:#0a0a0f;
      --ball2:#15152a;
      --shine: rgba(255,255,255,.22);
      --qbGreen:#2ca01c;
      --qbGreen2:#1d7f13;

      /* Perfect-circle ball size that adapts on small screens */
      --ballSize: clamp(200px, 54vw, 240px);
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      min-height:100vh;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--ink);
      background:
        radial-gradient(1200px 600px at 25% 10%, rgba(44,160,28,.22) 0%, transparent 60%),
        radial-gradient(900px 520px at 85% 30%, rgba(44,160,28,.18) 0%, transparent 55%),
        linear-gradient(160deg, #f6f8fb, #eaf0f6);
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding: 18px 16px 28px;
      overflow-x: hidden; /* prevent tiny horizontal scroll/cropping */
    }

    /* Side-by-side layout (desktop) with safe mobile wrapping */
    .wrap{
      width:min(1100px, 100%);
      display:flex;
      gap: 32px;
      align-items:stretch;

      /* Critical: prevents â€œshrink to deathâ€ on mobile */
      flex-wrap: wrap;
    }

    .card{
      background: rgba(255,255,255,.76);
      border: 1px solid rgba(0,0,0,.06);
      border-radius: 24px;
      box-shadow: 0 18px 60px rgba(0,0,0,.12);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      overflow:hidden;
    }

    /* Critical: force wrap earlier and avoid cropping */
    .left, .right{
      flex: 1 1 480px;
      min-width: 320px;
    }

    /* Stack on â€œreal-world mobile webâ€ widths */
    @media (max-width: 980px){
      .wrap{ flex-direction: column; gap: 14px; }
      .left{ padding: 18px; }
      .right{ padding: 14px; }
      body{ padding-top: 12px; }
    }

    .left{
      padding: 26px;
      display:flex;
      flex-direction:column;
      gap: 14px;
    }

    h1{
      margin:0;
      font-size: clamp(28px, 6vw, 44px);
      letter-spacing: -0.02em;
      line-height:1.05;
      color: #ff4fa3;
      text-shadow: 0 4px 18px rgba(255,79,163,.45);
    }

    p{
      margin:0;
      color: var(--muted);
      line-height:1.55;
      font-size: 15.5px;
    }

    .controls{
      margin-top: 10px;
      display:flex;
      flex-wrap:wrap;
      gap: 10px;
      align-items:center;
    }

    button{
      border: 0;
      cursor:pointer;
      padding: 12px 16px;
      border-radius: 999px;
      font-weight: 700;
      color: white;
      background: linear-gradient(135deg, var(--qbGreen), var(--qbGreen2));
      box-shadow: 0 10px 22px rgba(44,160,28,.22);
      transition: transform .08s ease, filter .15s ease;
    }
    button:active{ transform: scale(.98); }
    button:hover{ filter: brightness(1.03); }

    .ghost{
      background: rgba(255,255,255,.6);
      color: #0b1020;
      border: 1px solid rgba(0,0,0,.10);
      box-shadow:none;
    }

    .hint{
      font-size: 12.5px;
      color: rgba(11,16,32,.72);
      display:flex;
      gap: 10px;
      align-items:center;
      flex-wrap:wrap;
    }

    kbd{
      font-size: 12px;
      padding: 3px 8px;
      border-radius: 8px;
      border: 1px solid rgba(0,0,0,.12);
      background: rgba(255,255,255,.75);
      color: rgba(11,16,32,.9);
    }

    .small{
      font-size: 12px;
      color: rgba(11,16,32,.62);
    }

    /* Right panel: lighter QB card so the ball pops */
    .right{
      padding: 16px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      gap: 10px;
      position:relative;
      overflow:hidden;
      background: linear-gradient(180deg, rgba(44,160,28,.10), rgba(255,255,255,.85));
      border: 1px solid rgba(44,160,28,.25);
    }

    .right:before{
      content:"";
      position:absolute;
      inset: 0;
      background: url('bill-pay-socks.png') center / 420px no-repeat;
      opacity: 0.16;
      pointer-events: none;
      z-index: 0;
    }

    @media (max-width: 980px){
      .right:before{
        background-size: 300px;
        opacity: 0.14;
      }
    }

    .right > *{ position: relative; z-index: 1; }

    .ball-area{
      width: var(--ballSize);
      height: var(--ballSize);
      display:grid;
      place-items:center;
      position:relative;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    .ball{
      width: var(--ballSize);
      height: var(--ballSize);
      border-radius: 50%;
      background: radial-gradient(120px 120px at 25% 18%, rgba(255,255,255,.12), transparent 70%),
                  radial-gradient(380px 380px at 60% 70%, var(--ball2), var(--ball));
      box-shadow:
        0 24px 50px rgba(0,0,0,.35),
        inset 0 -22px 48px rgba(255,255,255,.05),
        inset 0 16px 36px rgba(255,255,255,.06);
      position:relative;
      display:grid;
      place-items:center;
      transform-origin: 50% 50%;
      transition: transform .18s ease;
    }

    .ball:before{
      content:"";
      position:absolute;
      inset: 9% 12% 62% 12%;
      border-radius: 999px;
      background: linear-gradient(180deg, var(--shine), transparent);
      filter: blur(1px);
      opacity:.9;
    }

    .window{
      width: 56%;
      height: 56%;
      border-radius: 50%;
      background: radial-gradient(120px 120px at 50% 35%, rgba(255,255,255,.08), rgba(0,0,0,.45) 62%, rgba(0,0,0,.70) 100%);
      border: 1px solid rgba(255,255,255,.12);
      display:grid;
      place-items:center;
      padding: 12px;
      position:relative;
    }

    .circle{
      width: 88%;
      height: 88%;
      border-radius: 50%;
      background: radial-gradient(120px 120px at 50% 30%, rgba(44,160,28,.95), rgba(29,127,19,.75) 55%, rgba(10,25,12,.85) 100%);
      border: 1px solid rgba(255,255,255,.18);
      display:grid;
      place-items:center;
      padding: 12px;
      box-shadow: inset 0 0 30px rgba(0,0,0,.35);
      position:relative;
      overflow:hidden;
    }

    .circle:after{
      content:"";
      position:absolute;
      inset:-30% -30% -30% -30%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.22), transparent 45%);
      transform: rotate(-18deg);
      opacity:.55;
    }

    .answer{
      position:relative;
      text-align:center;
      font-weight: 800;
      letter-spacing: .06em;
      line-height:1.12;
      color: rgba(255,255,255,.96);
      text-shadow: 0 4px 10px rgba(0,0,0,.45);
      font-size: 13px; /* JS will shrink-to-fit */
      padding: 0 10px;
      max-width: 100%;
      overflow-wrap: anywhere;
      word-break: break-word;
      opacity: 0;
      transform: translateY(6px);
      transition: opacity .25s ease, transform .25s ease;
    }

    .answer.show{ opacity: 1; transform: translateY(0); }

    .label{
      margin-top: 6px;
      color: rgba(11,16,32,.62);
      font-size: 12.5px;
      text-align:center;
    }

    .full-answer{
      margin-top: 6px;
      padding: 10px 12px;
      width: min(460px, 100%);
      text-align: center;
      font-size: 16px;
      line-height: 1.45;
      font-weight: 800;
      color: #ff4fa3;
      background: rgba(255,255,255,.75);
      border: 1px solid rgba(44,160,28,.18);
      border-radius: 14px;
      box-shadow: 0 8px 24px rgba(0,0,0,.12);
      min-height: 44px;
    }

    .shake{ animation: shake .55s cubic-bezier(.36,.07,.19,.97) both; }

    @keyframes shake{
      0%{ transform: translate3d(0,0,0) rotate(0deg); }
      15%{ transform: translate3d(-6px, 3px,0) rotate(-6deg); }
      30%{ transform: translate3d(8px, -2px,0) rotate(7deg); }
      45%{ transform: translate3d(-10px,-2px,0) rotate(-8deg); }
      60%{ transform: translate3d(10px, 3px,0) rotate(8deg); }
      75%{ transform: translate3d(-6px, -1px,0) rotate(-5deg); }
      100%{ transform: translate3d(0,0,0) rotate(0deg); }
    }

    .pulse{ animation: pulse 1.4s ease-in-out infinite; opacity: .95; }

    @keyframes pulse{ 0%,100%{ transform: translateY(0); } 50%{ transform: translateY(-3px); } }

    .toast{
      width: 100%;
      text-align:center;
      font-size: 12.5px;
      color: rgba(11,16,32,.65);
      min-height: 18px;
    }

    a{ color: var(--qbGreen); }
  </style>
</head>
<body>
  <div class="wrap">
    <section class="card left">
      <h1>Ask Sivan</h1>
      <p>
        While Sivan is leaving Bill Pay, she wanted to leave you with the answers to all questions that are Bill Pay.
        Shake the 8-ball for instant wisdom (and the occasional coffee suggestion).
      </p>

      <div class="controls">
        <button id="shakeBtn" aria-label="Shake the 8-ball">Shake</button>
        <button id="enableMotionBtn" class="ghost" aria-label="Enable device motion">Enable phone shake</button>
        <button id="copyBtn" class="ghost" aria-label="Copy the last answer">Copy answer</button>
      </div>

      <div class="hint" style="margin-top:10px;">
        <span>Tip:</span>
        <span>Try rapid clicks for extra chaos.</span>
        <span class="small">(No duplicates control â€” itâ€™s truly random.)</span>
      </div>

      <div style="margin-top:14px" class="small">
        Want to customize? Edit the <code>PHRASES</code> array in the script.
      </div>
    </section>

    <section class="card right">
      <div class="ball-area" id="ballArea" role="button" tabindex="0" aria-label="Magic 8-ball">
        <div class="ball pulse" id="ball">
          <div class="window">
            <div class="circle" id="answerContainer">
              <div class="answer" id="answer">Shake me</div>
            </div>
          </div>
        </div>
      </div>
      <div class="label">Magic 8-ball (team edition)</div>
      <div class="full-answer" id="fullAnswer"></div>
      <div class="toast" id="toast"></div>
    </section>
  </div>

  <script>
    const PHRASES = [
      "Have you thought of HVBs?",
      "The world does not end at the end of this Q",
      "Ask Jesse",
      "What about RBAC?",
      "Can we build it faster?",
      "What are the dependencies?",
      "Did it cause duplicate payments?",
      "Can we do it with contribution?",
      "Do we need MSE for this?",
      "Does this need to go through experience review?",
      "Is this highly requested in CES?",
      "What was the user feedback?",
      "What is the main KPI?",
      "What will this impact?",
      "What did Spend say about this?",
      "Send a summary of the meeting",
      "Schedule some time to discuss it with the whole team",
      "We should go to Happy Feet",
      "Book the Ameswell",
      "Coffee",
      "Will this impact the network?",
      "Can we make the CTA clearer?",
      "What about IES?"
    ];

    const ball = document.getElementById('ball');
    const ballArea = document.getElementById('ballArea');
    const answerEl = document.getElementById('answer');
    const answerContainer = document.getElementById('answerContainer');
    const shakeBtn = document.getElementById('shakeBtn');
    const enableMotionBtn = document.getElementById('enableMotionBtn');
    const copyBtn = document.getElementById('copyBtn');
    const toast = document.getElementById('toast');
    const fullAnswerEl = document.getElementById('fullAnswer');

    let lastAnswer = "";
    let isShaking = false;

    function pickRandom(arr){
      const i = Math.floor(Math.random() * arr.length);
      return arr[i];
    }

    function showToast(msg, ms=1400){
      toast.textContent = msg;
      if(!msg) return;
      window.clearTimeout(showToast._t);
      showToast._t = window.setTimeout(() => { toast.textContent = ""; }, ms);
    }

    function fitTextToCircle(){
      if(!answerContainer) return;

      const maxW = answerContainer.clientWidth - 8;
      const maxH = answerContainer.clientHeight - 8;

      answerEl.style.fontSize = '13px';
      answerEl.style.maxWidth = '100%';

      let size = 13;
      void answerEl.offsetHeight;

      while(size > 8 && (answerEl.scrollWidth > maxW || answerEl.scrollHeight > maxH)){
        size -= 1;
        answerEl.style.fontSize = size + 'px';
        void answerEl.offsetHeight;
      }
    }

    function makeTeaser(text){
      const words = text.split(' ');
      let teaser;
      if(words.length <= 4) teaser = text;
      else teaser = words.slice(0, 4).join(' ') + 'â€¦';
      return teaser.toUpperCase();
    }

    function setAnswer(text){
      const teaser = makeTeaser(text);
      answerEl.classList.remove('show');
      void answerEl.offsetWidth;
      answerEl.textContent = teaser;
      answerEl.classList.add('show');
      lastAnswer = text;
      fullAnswerEl.textContent = text;
      requestAnimationFrame(fitTextToCircle);
    }

    function shake(){
      if(isShaking) return;
      isShaking = true;

      ball.classList.remove('pulse');
      ball.classList.add('shake');

      window.setTimeout(() => {
        const next = pickRandom(PHRASES);
        setAnswer(next);
      }, 320);

      window.setTimeout(() => {
        ball.classList.remove('shake');
        ball.classList.add('pulse');
        isShaking = false;
      }, 560);
    }

    shakeBtn.addEventListener('click', shake);
    ballArea.addEventListener('click', shake);
    ballArea.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        shake();
      }
    });

    window.addEventListener('keydown', (e) => {
      if(e.code === 'Space'){
        e.preventDefault();
        shake();
      }
    });

    copyBtn.addEventListener('click', async () => {
      if(!lastAnswer){
        showToast('Shake first ðŸ™‚');
        return;
      }
      try{
        await navigator.clipboard.writeText(lastAnswer);
        showToast('Copied!');
      }catch{
        const ta = document.createElement('textarea');
        ta.value = lastAnswer;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        ta.remove();
        showToast('Copied!');
      }
    });

    let motionEnabled = false;
    let lastShakeAt = 0;
    const SHAKE_THRESHOLD = 18;
    const SHAKE_COOLDOWN_MS = 900;

    function handleMotion(e){
      const acc = e.accelerationIncludingGravity;
      if(!acc) return;
      const now = Date.now();
      const magnitude = Math.sqrt((acc.x||0)**2 + (acc.y||0)**2 + (acc.z||0)**2);
      if(magnitude > SHAKE_THRESHOLD && (now - lastShakeAt) > SHAKE_COOLDOWN_MS){
        lastShakeAt = now;
        shake();
      }
    }

    async function enableMotion(){
      try{
        if(typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function'){
          const res = await DeviceMotionEvent.requestPermission();
          if(res !== 'granted'){
            showToast('Motion permission not granted');
            return;
          }
        }
        window.addEventListener('devicemotion', handleMotion, { passive: true });
        motionEnabled = true;
        enableMotionBtn.textContent = 'Phone shake enabled';
        showToast('Shake your phone ðŸ“±');
      }catch(err){
        console.warn(err);
        showToast('Device motion not available');
      }
    }

    enableMotionBtn.addEventListener('click', () => {
      if(motionEnabled){
        showToast('Already enabled');
        return;
      }
      enableMotion();
    });

    setAnswer('Shake me');
    window.addEventListener('resize', () => requestAnimationFrame(fitTextToCircle));
  </script>
</body>
</html>
